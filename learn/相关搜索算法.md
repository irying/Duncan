# 相关搜索算法和数据收集

经讨论之后的算法有3种

1.纯后继词

2.搜索词维度--推搜索词

3.用户维度--推搜索词



#### 1.纯后继词：以用户和搜索词推搜索词

​	1）搜索日志那次这样的记录

```
key:搜索词 time:搜索时间 用户A result:a,b,c,d,e（前5个搜索结果）
key:搜索词 time:搜索时间 用户B result:b,h,i,d,e（前5个搜索结果）
key:搜索词 time:搜索时间 用户C result:b,h,a,c,b（前5个搜索结果）
...
```

​	规则：某个词b只有出现在5个用户的相同的搜索词a的后继词中才算一个A的后继词

```
key：a succeed：b,c,d.....
```



#### 2.搜索词维度--推搜索词：以搜索词推相似的搜索词，相似性取决于搜索结果或者点击结果

```
key：搜索词A click:结果A 结果B 结果C
key：搜索词B click:结果A 结果B 结果D
```

如果某个搜索结果出现在了不同的搜索词的结果集中，那么这些个搜索词很可能是相关的，如果这个<u>搜索结果在不同的搜索词下都被点击了，那么这些个词的相关性就更高了。</u> 



#### 3.用户维度--推搜索词：以搜索词相似用户，协同过滤

```
用户A  ： 搜索词A  搜索词B 搜索词C....
用户B  ： 搜索词B  搜索词A 搜索词D.....
```

如果某些搜索词都出现在在两个用户的搜索里，那么这两个用户很可能是相似的。



#### 每次点击搜索上报的数据

uuid维度协同过滤 or 纯后继词

uuidA->[keyword..]
uuidB->[keyword...]

| uuid   | userid | keyword | create_time | mid    |
| ------ | ------ | ------- | ----------- | ------ |
| 设备id | 用户id | 搜索词  | 创建时间    | 模板id |

#### 每次在搜索结果页,点击模板上报的数据

keyword维度协同过滤

keywordA->[mid..]
keywordB->[mid...]

| keyword | mid        | create_time |
| ------- | ---------- | ----------- |
| 搜索词  | 点击的模板 | 创建时间    |

